#!/usr/bin/env bash

# 1. 获取 msg 文本

echo ${1}
msg=`cat ${1}`
echo -e "\n\n[commit-msg 为 \"${msg}\"]\n "

# commit-msg 的 msg 是存储到 .git/COMMIT_EDITMSG 文件里的，
# 而这个文件会作为第一个参数来执行本脚本，
# 所以我们可以通过 ${1} 获取到这个文件，然后通过 cat 命令来读取 msg 文本


# 2. 编写正则

releaseRE=^v\d
commitRE=^(revert: )?(feat|fix|docs|dx|refactor|perf|test|workflow|build|ci|chore|types|wip|release|deps|style)(\(.+\))?: .{1,50}

# 3. 进行正则匹配

if [[ $msg =~ $releaseRE && $msg =~ $commitRE ]]
then
  echo -e "[该 msg 符合规范，可以提交]"
  exit 0
else
  echo -e "[该 msg 不符合规范，请按照以下规则进行书写] \n "
  echo -e "[规范1]: 未定…… "
  echo -e "[规范2]: 未定…… "
  echo -e "[规范3]: 未定…… "
  exit 1
fi


